<!DOCTYPE html>
<html>
<head>
    <title>Barcode Scanner</title>
    <script src="https://cdn.jsdelivr.net/npm/quagga/dist/quagga.min.js"></script>
</head>
<body>
    <h1>Barcode Scanner</h1>
    <div id="scanner-container" style="width: 100%; height: 300px;"></div>
    <div id="result"></div>
    
    <script>
        let lastScanned = '';
        
        Quagga.init({
            inputStream: {
                name: "Live",
                type: "LiveStream",
                target: document.querySelector('#scanner-container'),
                constraints: {
                    facingMode: "environment"
                },
            },
            decoder: {
                readers: ["ean_reader", "ean_8_reader", "code_128_reader", "upc_reader"]
            },
        }, function(err) {
            if (err) {
                console.error(err);
                return;
            }
            Quagga.start();
        });

        Quagga.onDetected(function(result) {
            const code = result.codeResult.code;
            if (code !== lastScanned) {
                lastScanned = code;
                document.getElementById('result').innerHTML = `Scanned: ${code}`;
                
                // Send to your Java server
                fetch(`http://<your-PC-ip>:8000/scan`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ barcode: code })
                })
                .then(response => console.log('Success:', response))
                .catch(error => console.error('Error:', error));
            }
        });
    </script>
</body>
</html>
